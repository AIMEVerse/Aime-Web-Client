<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>PAI-TECH</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta name="keywords" content="PAI-TECH, BOT, OPERATING, SYSTEM,AIME,AI, Super computer">
    <meta name="author" content="EVE - PAI-DEV-BOT">
    <meta name="generator" content="PAI-BOT" />
    <meta content="PAI-TECH" name="title">
    <meta content="Making Computers Smarter" name="description">
    <meta content="PAI-TECH.ORG" property="og:site_name">
    <meta content="PAI-TECH | Making Computers Smarter" property="og:title">
    <meta content="Making Computers Smarter" property="og:description">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous">
    </script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Quicksand">

    

    
</head>

<body>
   
    <script type="module" defer>
       import { Spell,Spell3d, Spell3dModule,SpellUI, SpellUIModule,SpellData,PAIWebBot as WebBot,Wormholes } from '@pai-tech/spell'

        import * as THREE from 'three'
        //import "/node_modules/@pai-tech/spell/lib/style/spell.css"

        import "/src/pai-module/public/style/space-hud.css"
        SpellData.variables["ppl"] = 0
        let room_id = "2a6f3a8a-dec0-44d7-9ed2-65d9eab2a0f1"

        let wormhole_url =  "localhost:8080" // document.location.host //"_$wormhole_url" //data from ssr (server side rendering) 
        try {
            wormhole_url = SPELL_WORMHOLE_URL
        } catch (E){}

        Wormholes.open_wormhole(`ws://${wormhole_url}`)
        setTimeout(() => {
            
        
            
            Wormholes.send_wh_message(`get-room-data room-id:"08ccce2f-b2a2-4a2a-84dc-f079e063f0fc"`,(data) => {SpellData.variables["ppl"] = data.peoples},"pt")
            Wormholes.send_wh_message(`subscribe-client event:"room-data-changed"`,(data) => {console.log("client has been subscribed to event room-data-changed")},"pt")
            //Wormholes.close_wormhole()
        }, 1000);

        //import space_hud from "/public/style/space-hud.css"
        import {SpaceHudObjects,HudWindow} from './src/pai-module/spell-extended/space-hud.js'

        let delta = new THREE.Clock();


        let spell_ui_module = new SpellUIModule()
        spell_ui_module.import_objects(SpaceHudObjects)

        Spell.load_module(spell_ui_module)
        Spell.load_module(new Spell3dModule())
        Spell.start()

        const spellmodule = Spell.get_module('spell3d')

        const spell_app = {
            spell: {
                version: 1
            },
            views: {
                "main-view": {
                    _type: "view",
                    _id: "main-view",
                    style: "width:100%;margin: 0;padding:0;display:block",
                    "class": "container-fluid xyz-in ",
                    animation: "fade",
                    _spells: [
                        {
                            _id: "hud-1",
                            _type: "hud-window",
                            draggable:true,
                            _title: "PAI Control"
                        },
                        {
                            _id: "hud-2",
                            _type: "hud-menu",
                            draggable:true,
                            _title: "PAI Menu"
                        },
                        {
                            _id: "hud-3",
                            _type: "hud-form",
                            draggable:true,
                            _title: "PAI Form"
                        },
                        {
                            _id: "hud-4",
                            _type: "hud-favorites",
                            draggable:true,
                            // _title: "PAI Favorites"
                        }
                    ]
                }
            },
            defaults: {
                view: "main-view"
            },
            player: {
                html_element: "spell-player"
            }

        }


        SpellUI.load_app(spell_app)

        SpellUI.vm.show_view("main-view")


        document.addEventListener('room-data-changed', (event) => {
           const obj = JSON.parse(event.detail)
           
           SpellData.variables["ppl"] = obj.data[0]?.peoples
        }, false);

    </script>

    
    
    <div id="spell-player"></div>
    <img src"./public/images/SPACES2.png" />
    <spell></spell>

</body>


</html>